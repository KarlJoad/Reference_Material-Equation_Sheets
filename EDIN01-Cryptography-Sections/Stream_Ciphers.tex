\section{Stream Ciphers --- LFSR Sequences}\label{sec:Stream_Ciphers}
There are 2 main types of \nameref{def:Symmetric_Encryption} algorithms:
\begin{enumerate}[noitemsep]
\item \nameref{def:Block_Cipher}s
\item \nameref{def:Stream_Cipher}s
\end{enumerate}

\begin{definition}[Stream Cipher]\label{def:Stream_Cipher}
  \emph{Stream cipher}s encrypt individual characters of the \nameref{def:Plaintext} using an encryption transofrmation that varies with time.
  The 2 elements that make up a stream cipher are \textbf{memory} and a \textbf{combinatorial function}.
  \begin{enumerate}[noitemsep]
  \item Memory
    \begin{itemize}[noitemsep]
    \item \nameref{def:LFSR}s
    \item Tables (Arrays)
    \end{itemize}
  \item Combinatorial Function
    \begin{itemize}[noitemsep]
    \item Nonlinear Boolean functions, S-boxes
    \item XOR, Modular addition, cyclic rotations, multiplication
    \end{itemize}
  \end{enumerate}
\end{definition}

\begin{definition}[Keystream]\label{def:Keystream}
  The \emph{keystream} is the output of the generator, which gets used on the \nameref{def:Plaintext} message to form the \nameref{def:Ciphertext}
  \begin{equation}\label{eq:Keystream}
    \mathbf{z} = z_{1}, z_{2}, \ldots
  \end{equation}

  \begin{remark}[Attacks]\label{rmk:Keystream_Attack_Vectors}
    For a synchronous \nameref{def:Stream_Cipher}, a \nameref{def:Attack-Known_Plaintext}, \nameref{def:Attack-Chosen_Plaintext}, or \nameref{def:Attack-Chosen_Ciphertext} is equivalent to having access to the \nameref{def:Keystream}.
  \end{remark}

  \begin{remark}[Secret Key]\label{rmk:Keystream_Secret_Key}
    When the \nameref{def:Keystream} first starts, because it is a synchronous system, it needs to have a starting value with which to generate subsequent values.
    This first value may be fixed, and is the secret key, $K$, in this case.
  \end{remark}
\end{definition}

\subsection{Assumptions}\label{subsec:Stream_Cipher_Assumptions}
We assume that
\begin{itemize}[noitemsep]
\item The output \nameref{def:Keystream} of length $N$ is known to Eve.
\end{itemize}

\subsection{Attacks}\label{subsec:Stream_Cipher_Attacks}
An attack is considered successful only if the complexity of performing it is considerably lower than the exhaustive keysearch of complexity $2^{k}$.

The attack types that are of interest are:
\begin{itemize}[noitemsep]
\item \emph{\nameref{def:Attack-Key_Recovery}}: Eve tries to recover the \nameref{rmk:Keystream_Secret_Key}, $K$.
\item \emph{\nameref{def:Attack-Distinguishing}}: Eve tries to determine whether a given sequence $\hat{\mathbf{z}} = z_{1}, z_{2}, \ldots, z_{N}$ is likely to have been generated from the considered \nameref{def:Stream_Cipher}, or if it's a truly random sequence.
\end{itemize}

\begin{definition}[Key Recovery Attack]\label{def:Attack-Key_Recovery}
  In a \emph{key recovery attack}, Eve tries to recover the \nameref{rmk:Keystream_Secret_Key}, $K$.
\end{definition}

\begin{definition}[Distinguishing Attack]\label{def:Attack-Distinguishing}
  In a \emph{distinguishing attack}, Eve tries to determine whether a given sequence $\hat{\mathbf{z}} = z_{1}, z_{2}, \ldots, z_{N}$ is likely to have been generated from the considered \nameref{def:Stream_Cipher}, or if it's a truly random sequence.

  Let $D(\mathbf{z})$ be an algorithm that takes in a sequence $\mathbf{z}$ of length $N$, and outputs either ``X'' or ``RANDOM''.
  With probability $\frac{1}{2}$, the sequence $\mathbf{z}$ is produced by a generator $X$ otherwise, it is a random sequence.
  The probability that $D(\mathbf{z})$ correctly determines the origin of $\mathbf{z}$ is written $\Prob \bigl( D(\mathbf{z}) \bigr) = \frac{1}{2} + \epsilon$.
  If $\epsilon$ is not very close to zero, then $D(\mathbf{z})$ is a \emph{distinguisher} for the generator $X$, because it can more often than not distinguish that the sequence is nonrandom.

  \begin{remark}
    A \nameref{def:Attack-Distinguishing} is a much weaker attack than a \nameref{def:Attack-Key_Recovery}.
  \end{remark}
\end{definition}

\input{./EDIN01-Cryptography-Sections/Stream_Ciphers/Linear_Feedback_Shift_Registers}

\input{./EDIN01-Cryptography-Sections/Stream_Ciphers/LFSR_Sequences_Extension_Fields}


\subsection{Berlekamp-Massey Algorithm}\label{subsec:Berlekamp_Massey_Algorithm}
I will present this algorithm in 2 ways, a algorithm table and a flow chart.

\begin{algorithm}[H]
  \DontPrintSemicolon{}
  \SetKwInOut{Input}{Input}
  \SetKwInOut{Output}{Output}
  
  \Input{A sequence $\mathbf{s} = (s_{0}, s_{1}, \ldots, s_{N-1})$ of length $N$.}
  \Output{The shortest LFSR $\langle C(D)$, where $L \rangle$ generating $\mathbf{s}$.}
  \BlankLine{}
  \textit{Initialization}: $C(D) = 1$, $L=0$, $C^{*}(D) = 1$, $d^{*} = 1$, $m = -1$, and $n=0$. \;
  \While{$n < N$}{
    Compute the discrepancy $d$:
    \begin{equation*}
      d = s_{n} - \sum\limits_{i=1}^{L} -c_{i}s_{n-i}
    \end{equation*} \;
    \If{$d \neq 0$}{
      $T(D) = C(D)$ \;
      $C(D) = C(D) - ( d \cdot d^{-1}) \cdot (C^{*}(D))D^{n-m}$\;
      \If{$L \leq \frac{n}{2}$}{
        $L = n + 1 - L$ \;
        $C^{*}(D) = T(D)$ \;
        $d^{*} = d$ \;
        $m = n$ \;
      }
    }
    $n = n + 1$
  }
  \Return{$\langle C(D), L \rangle$}
  \caption{Berlekamp-Massey Algorithm}
  \label{fig:Berlekamp_Massey_Algorithm}
\end{algorithm}

\begin{figure}[h!]
  \centering
  
  \caption{Berlekamp-Massey Algorithm}
  \label{fig:Berlekamp_Massey_Algorithm}
\end{figure}

\subsection{Cycle Sets}\label{subsec:Cycle_Sets}
\begin{definition}[Cycle Set]\label{def:Cycle_Set}
  The \emph{cycle set} for $C(D)$ is the number of cycles of a given length.
  This is assuming $L = \Degree \bigl( C(D) \bigr)$.
  It is written
  \begin{equation}\label{eq:Cycle_Set}
    n_{1} \left( T_{1} \right) \XOR n_{1} \left( T_{1} \right) \XOR \cdots
  \end{equation}

  For example, $1(1) \XOR 3(5)$ means there is one cycle of length one, and three cycles of length 5.

  \begin{remark}[Combining]
    You can combine cycle with the same period by simple addition.
    \begin{equation}\label{eq:Cycle_Set_Addition}
      n_{1}(T) \XOR n_{2}(T) =  \left( n_{1} + n_{2} \right) (T)
    \end{equation}
  \end{remark}
\end{definition}

\subsubsection{Properties of \nameref*{subsec:Cycle_Sets}}\label{subsubsec:Cycle_Set_Properties}
\begin{propertylist}
\item If $C(D)$ is a \nameref{def:Polynomial_Ring_Properties-Primitive_Element} of \nameref{def:Polynomial_Degree} $L$ over \TextFiniteMathField{F}{q}{}, then the \nameref{def:Cycle_Set} is\label{prop:Cycle_Set_Properties-Primitive_Polynomial}
  \begin{equation}\label{eq:Primitive_Polynomial_Cycle_Set}
    1(1) \XOR 1 \left( q^{L}-1 \right)
  \end{equation}
\item If $C(D)$ is an \nameref{def:Irreducible_Polynomial} \nameref{def:Polynomial}, then the \nameref{def:Cycle_Set} is\label{prop:Cycle_Set_Properties-Irreducible_Polynomial}
  \begin{equation}\label{eq:Irreducible_Polynomial_Cycle_Set}
    1(1) \XOR \frac{ \left(q^{L} - 1 \right)}{T} (T)
  \end{equation}
  where $T$ is the \nameref{def:Polynomial_Period} of $C(D)$, or the \nameref{def:Element_Order} of $\alpha$ when $\pi(\alpha)=0$.
\end{propertylist}

\begin{theorem}[Connection Polynomial Multiple]\label{thm:Cycle_Set_Multiple_of_Connection_Polynomial}
  If $C(D) = {C_{1}(D)}^{n}$, then the \nameref{def:Cycle_Set} of $C(D)$ is
  \begin{equation}\label{eq:Cycle_Set_Multiple_of_Connection_Polynomial}
    1(1) \XOR \frac{\left( q^{L_{1}}-1 \right)}{T_{1}} \left( T_{1} \right) \XOR \frac{q^{L_{1}} \left( q^{L_{1}}-1 \right)}{T_{2}} \left( T_{2} \right) \XOR \cdots \XOR \frac{q^{(n-1)L_{1}}\left( q^{L_{1}}-1 \right)}{T_{n}} \left( T_{n} \right)
  \end{equation}
  where $\Degree \bigl( C(D) \bigr) = L$ and $T_{j}$ is the \nameref{def:Polynomial_Period} of ${C_{1}(D)}^{j}$.
\end{theorem}

\begin{theorem}[Irreducible Connection Polynomial Multiple]\label{thm:Irreducible_Connection_Polynomial_Multiple_Cycle_Set}
  if $C_{1}(D)$ is \nameref{def:Irreducible_Polynomial} with period $T_{1}$, then the \nameref{def:Polynomial_Period} of ${C_{1}(D)}^{j}$ is
  \begin{equation}\label{eq:Irreducible_Connection_Polynomial_Multiple_Cycle_Set}
    T_{j} = p^{m}T_{1}
  \end{equation}
  where $p$ is the \nameref{def:Field_Characteristic} of the \nameref{def:Field} and $m$ is the integer satisfying
  \begin{equation}\label{eq:Irreducible_Connection_Polynomial_Multiple_Cycle_Set_Requirement}
    p^{m-1} < j \leq p^{m}
  \end{equation}
\end{theorem}

\begin{example}[Lecture 9, Example 4.9]{Cycle Set of Connection Polynomial}
  Compute the \nameref{def:Cycle_Set} for the \nameref{def:Connection_Polynomial} $C(D) = {\left( 1+D+D^{2} \right)}^{3}$ in \TextFiniteMathField{F}{2}{}?
  \tcblower{}
  The \nameref{def:Connection_Polynomial} here is actually in the form $C(D) = {C_{1}(D)}^{3}$.
  In this case, $C_{1}(D) = 1+D+D^{2}$, which is both \nameref{def:Irreducible_Polynomial} and \nameref{def:Polynomial_Ring_Properties-Primitive_Element}.

  We can find the \nameref{def:Polynomial_Period} in 3 ways.
  \begin{enumerate}[noitemsep]
  \item Because it's $C_{1}(D)$ is a primitive \nameref{def:Polynomial}, $T_{1}=q^{L}-1 = 3$.
  \item Could perform a \nameref{def:Polynomial_Period}, which yields the same thing.
  \item Because it's $C_{1}(D)$ is a primitive \nameref{def:Polynomial}, $\pi(\alpha)=0$, and the $\ElementOrder \left( \alpha^{2} \right) = 3$.
  \end{enumerate}

  Now, $T_{2}$ must be calculated with $T_{2} = 2^{m_{2}} \cdot 3$, where $2^{m_{2}-1} < 2 \leq 2^{m_{2}}$.
  $m_{2} = 1$, plugging that back in gives $T_{2} = 2$.

  Doing the same for $T_{3}$ yields $T_{3} = 12$.

  Now we combine these into a single line.
  \begin{align*}
    1(1) &\XOR \frac{ \left( 2^{2} - 1 \right)}{3} (3) \XOR \frac{ 2^{2} \left( 2^{2} - 1 \right)}{3} (6) \XOR \frac{2^{6} \left( 2^{2} - 1 \right)}{3} (12) \\
    1(1) &\XOR 1 (3) \XOR 2 (6) \XOR 4 (12)
  \end{align*}
\end{example}

\begin{theorem}[Arbitrary Connection Polynomial]\label{thm:Arbitrary_Connection_Polynomial}
  For a \nameref{def:Connection_Polynomial} $C(D)$ factoring like
  \begin{equation*}
    C(D) = {C_{1}(D)}^{n_{1}} {C_{2}(D)}^{n_{2}} \cdots {C_{m}(D)}^{n_{m}}
  \end{equation*}
  $C_{i}(D)$ is \nameref{def:Irreducible_Polynomial}, has a \nameref{def:Cycle_Set} $S_{1} \times S_{2} \times \cdots S_{m}$, where $S_{i}$ is the \nameref{def:Cycle_Set} for $C_{i}^{e_{i}}$, and
  \begin{equation}\label{eq:Arbitrary_Connection_Polynomial}
    n_{1} \left( T_{1} \right) \times n_{2} \left( T_{2} \right) = n_{1}n_{2} \gcd(T_{1}, T_{2}) \bigl( \lcm(T_{1}, T_{2}) \bigr)
  \end{equation}
  and the distributive law holds for $\times$ and $\XOR$.
\end{theorem}

\subsection{Decimation}\label{subsec:Decimation}
An \nameref{def:M_Sequence} $\mathbf{s} = s_{0}, s_{1}, s_{2}, \ldots$.
\begin{itemize}[noitemsep]
\item Define the sequence $\mathbf{s}'$ obtained through decimation by $k$, defined by the sequence
  \begin{equation*}
    \mathbf{s}' = s_{0}, s_{k}, s_{2k}, \ldots
  \end{equation*}
\item $\mathbf{s}$ corresponds to a multiplication of $\beta$ by the fixed element $\alpha$. Thus, $\mathbf{s}'$ corresponds to multiplication $\beta$ by the fixed element $\alpha^{k}$, which means the cycle of different states corresponds to
  \begin{equation*}
    \beta, \alpha^{k}\beta, \alpha^{2k}\beta, \ldots, \alpha^{(T-1)k}\beta, \left( \alpha^{Tk}\beta = \beta \right)
  \end{equation*}
\item The period of $\mathbf{s}'$ is $\ElementOrder \left( \alpha^{k} \right) = \dfrac{q^{L}-1}{\gcd \left( q^{L}-1, k \right)}$.
\end{itemize}

\subsection{Statistical Properties}\label{subsec:LFSR_Statistical_Properties}
The importance of \nameref{def:LFSR} sequences and \nameref{def:M_Sequence}s are due to their pseudorandomness properties.
$\mathbf{s} = s_{0}, s_{1}, \ldots$ is an \nameref{def:M_Sequence}, and an $n$-gram is a subsequence of length $n$,
\begin{equation*}
  \left( s_{t}, s_{t+1}, \ldots, s_{t+n-1} \right)
\end{equation*}
for $t=0, 1, \ldots$

\begin{theorem}
  Among the $q^{L}-1$ $L$-grams that can be constructed for $t = 0, 1, \ldots, q^{L}-2$, ever nonzero vector appears exactly once.
\end{theorem}

\subsubsection{Autocorrelation Function}\label{subsubsec:Autocorrelation_Function}
\begin{definition}[Autocorrelation Function]\label{def:LFSR_Autocorrelation_Function}
  The \emph{autocorrelation function} has:
  \begin{itemize}[noitemsep]
  \item 2 binary sequences, $\mathbf{x}, \mathbf{y}$ of the same length $n$.
  \item The autocorrelation $C(\mathbf{x}, \mathbf{y})$ between the 2 sequences is defined as the number of positions of agreements minus the number of disagreements.
  \item The autocorrelation function $C(\tau)$ is defined to be the correlation between a sequence $\mathbf{x}$ and its $\tau$th cyclic shift, i.e.,
    \begin{equation}\label{eq:LFSR_Autocorrelation_Function}
      C(\tau) = \sum\limits_{i=1}^{n} {(-1)}^{x_{i}+x_{i+\tau}}
    \end{equation}
    where subscripts are taken modulo $n$ and addition in the exponent is $\mod{2}$ addition.
  \end{itemize}
\end{definition}

\begin{theorem}[Autocorrelation of $m$-Sequence]\label{thm:M_Sequence_Autocorrelation}
  If $\mathbf{s}$ is an $m$-sequence of length $2^{L}-1$, then
  \begin{equation}\label{eq:M_Sequence_Autocorrelation}
    C(\tau) =
    \begin{cases}
      2^{L} - 1 & \text{ if } \tau \equiv 0 \bmod n \\
      -1 & \text{otherwise} \\
    \end{cases}
  \end{equation}
\end{theorem}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../EDIN01-Cryptography-Reference_Sheet"
%%% End:
