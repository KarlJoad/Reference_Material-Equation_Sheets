\section{Number Theory}\label{sec:Number_Theory}
Before we can start with any of the deeper cryptography stuff, we need to start with some basic number theory.
\begin{definition}[Number Theory]\label{def:Number_Theory}
  \emph{Number theory} is a branch of pure mathematics devoted primarily to the study of the integers and integer-valued functions.
  Number theorists study prime numbers as well as the properties of objects made out of integers (for example, rational numbers) or defined as generalizations of the integers (for example, algebraic integers).
\end{definition}

\begin{definition}[Divides]\label{def:Divides}
  For $a, b \in \AllIntegers$, we say that $a$ \emph{divides} $b$ (written $a \Divides b$) if there exists an integer $c$ such that $b = ac$.

  Properties:
  \begin{propertylist}
  \item $a \Divides a$
  \item If $a \Divides b$ and $b \Divides c$, then $a \Divides c$.
  \item If $a \Divides b$ and $a \Divides c$, then $a \Divides (bx + cy)$ for any $x, y \in \AllIntegers$.
  \item If $a \Divides b$ and $b \Divides a$, then $a = \pm b$.
  \end{propertylist}
\end{definition}

\subsection{Integer Long Division}\label{subsec:Integer_Long_Division}
For $a, b \in \AllIntegers$, with $b \geq 1$.
Then an ordinary long division of $a$ by $b$, i.e. $a \div b$ yields two integers $q$ and $r$ such that
\begin{equation}\label{eq:Integer_Long_Division}
  a = qb + r, \text{where } 0 \leq r < b
\end{equation}

$q$ and $r$ are called the \nameref{def:Integer_Quotient} and \nameref{def:Integer_Remainder}, respectively, and are \textbf{unique}.

\begin{definition}[Quotient]\label{def:Integer_Quotient}
  The \emph{quotient}, $q$, of $a$ divided by $b$ is denoted $a \DIV b$.
\end{definition}

\begin{definition}[Remainder]\label{def:Integer_Remainder}
  The \emph{remainder}, $r$, of $a$ divided by $b$ is denoted $a \bmod b$.
\end{definition}

\begin{example}[]{Integer Long Division}
  If $a=53$ and $b=9$, what is $a \bmod b$?

  \tcblower{}

  \begin{align*}
    53 &= q9 + r \\
    q &= 5 \\
    r &= 8
  \end{align*}

  Thus, $53 \bmod 9 = 8$.
\end{example}

\subsection{Greatest Common Divisor}\label{subsec:Greatest_Common_Divisor}
\begin{definition}[Common Divisor]\label{def:Common_Divisor}
  An integer $c$ is a \emph{common divisor} of $a$ and $b$ if $c \Divides a$ and $c \Divides b$.
\end{definition}

\begin{definition}[Greatest Common Divisor]\label{def:GCD}
  A non-negative integer $d$ is called the \emph{greatest common divisor} (\emph{GCD}) of integers $a$ and $b$ if:
  \begin{enumerate}[noitemsep]
  \item $d$ is a \nameref{def:Common_Divisor} of $a$ and $b$.
  \item For every other common divisor $c$ it holds that $c \Divides d$.
  \end{enumerate}

  The greatest common divisor is denoted
  \begin{equation}\label{eq:GCD}
    \gcd(a, b)
  \end{equation}

  $\gcd(a,b)$ is the \textbf{largest positive} integer dividing both $a$ and $b$ (except for $\gcd(0,0)=0$).
  
  \begin{remark}
    If $a, b \in \PositiveInts$, then $\lcm(a, b) \cdot \gcd(a, b) = a \cdot b$
  \end{remark}
\end{definition}

\begin{example}[]{Greatest Common Divisor}
  What is the $\gcd(18, 24)$?

  \tcblower{}

  Common Divisors = $\lbrace \pm 1, \pm 2, \pm 4, \pm 6 \rbrace$.

  Since we can only allow positive integers,
  \begin{equation*}
    \gcd(18, 24) = +6
  \end{equation*}
\end{example}

\subsection{Least Common Multiple}\label{subsec:Least_Common_Multiple}
\begin{definition}[Least Common Multiple]\label{def:LCM}
  A non-negative integer $d$ is called the \emph{least common multiple} (\emph{LCM}) of integers $a$ and $b$ if:
  \begin{enumerate}[noitemsep]
  \item $a \Divides d$ and $b \Divides d$
  \item For every integer $c$ such that $a \Divides c$ and $b \Divides c$, we have $d \Divides c$.
  \end{enumerate}

  The least common multiple is denoted
  \begin{equation}\label{eq:LCM}
    \lcm(a, b)
  \end{equation}

  $\lcm(a, b)$ is the \textbf{smallest positive} integer divisible by both $a$ and $b$.

  \begin{remark}
    If $a, b \in \PositiveInts$, then $\lcm(a, b) \cdot \gcd(a, b) = a \cdot b$
  \end{remark}
\end{definition}

\subsection{Primality}\label{subsec:Primality}
\begin{definition}[Relatively Prime]\label{def:Relatively_Prime}
  $a, b$ are called \emph{relatively prime} if $\gcd(a, b) = 1$.
\end{definition}

\begin{definition}[Prime]\label{def:Prime}
  An integer $p \geq 2$ is called \emph{prime} if its only positive divisors are $1$ and $p$.
  Otherwise, $p$ is called a \emph{\nameref{def:Composite}}.
\end{definition}

\begin{definition}[Composite]\label{def:Composite}
  An integer $p \geq 2$ is called \emph{composite} if it has more positive divisors than just $1$ and $p$.
  Otherwise, $p$ is called a \emph{\nameref{def:Prime}}.
\end{definition}

\subsubsection{Number of Primes}\label{subsubsec:Number_of_Primes}
The number of primes $\leq x$ is denoted
\begin{equation}\label{eq:Number_of_Primes}
  \pi(x)
\end{equation}
\begin{enumerate}[noitemsep]
\item There are infinitely many primes
\item $\lim\limits_{x \rightarrow \infty} \frac{\pi(x)}{\frac{x}{\ln(x)}} = 1$
\item For $x \geq 17$, $\frac{x}{\ln(x)} < \pi(x) < \frac{1.25506x}{\ln(x)}$
\end{enumerate}

\subsection{Unique Factorization}\label{subsec:Unique_Factorization}
\begin{theorem}[Unique Factorization Theorem]\label{thm:Unique_Factorization_Theorem}
  Every integer $n \geq 2$ can be written as a product of prime powers,
  \begin{equation*}
    n = p_{1}^{e_{1}} p_{2}^{e_{2}} \cdots p_{k}^{e_{k}}
  \end{equation*}
  where $p_{1}, p_{2}, \ldots p_{k}$ are distinct primes and $e_{1}, e_{2}, \ldots e_{k}$ are positive integers.
  Furthermore, the factorization is unique up to rearrangement of the factors.
\end{theorem}

\subsubsection{\nameref*{def:GCD} and \nameref*{def:LCM} with Unique Factors}\label{subsubsec:GCD_LCM_Unique_Factors}
If $a = p_{1}^{e_{1}} p_{2}^{e_{2}} \cdots p_{k}^{e_{k}}$ and $b = p_{1}^{f_{1}} p_{2}^{f_{2}} \cdots p_{k}^{e_{k}}$, where $e_{i}, f_{i}, i = 1, 2, \ldots k$ are non-negative integers, then
\begin{equation}\label{eq:GCD_Unique_Factors}
  \gcd(a, b) = p_{1}^{\min(e_{1}, f_{1})} p_{2}^{\min(e_{2}, f_{2})} \cdots p_{k}^{\min(e_{k}, f_{k})}
\end{equation}
and
\begin{equation}\label{eq:LCM_Unique_Factors}
  \lcm(a, b) = p_{1}^{\max(e_{1}, f_{1})} p_{2}^{\max(e_{2}, f_{2})} \cdots p_{k}^{\max(e_{k}, f_{k})}
\end{equation}

\subsection{Euler Phi Function}\label{subsec:Euler_Phi_Function}
\begin{definition}[Euler Phi Function]\label{def:Euler_Phi_Function}
  For $n \geq 1$, let $\phi(n)$ denote the number of integers in the interval $[1, n]$, which are \nameref{def:Relatively_Prime} to $n$.
  This function is called the \emph{Euler Phi Function}.
  \begin{equation}\label{eq:Euler_Phi_Function}
    \phi(n) = \left( p_{1}^{e_{1}} - p_{1}^{e_{1}-1} \right) \left( p_{2}^{e_{2}} - p_{2}^{e_{2}-1} \right) \cdots \left( p_{k}^{e_{k}} - p_{k}^{e_{k}-1} \right)
  \end{equation}
  \begin{remark}
    The \nameref{def:Euler_Phi_Function} is closely related to \nameref{def:Set_Order}.
  \end{remark}
\end{definition}

\begin{theorem}[Euler Phi Function]\label{thm:Euler_Phi_Function}
  There are a few properties of the \nameref{def:Euler_Phi_Function} that we will treat as true because of this theorem.
  \begin{propertylist}
  \item If $p$ is a \nameref{def:Prime}, then $\phi(p) = p - 1$.\label{prop:Euler_Phi_Function_Properties-Prime_Number}
  \item If $\gcd(a, b) = 1$, then $\phi(ab) = \phi(a) \phi(b)$.\label{prop:Euler_Phi_Function_Properties-Split_Multiplication}
  \item If $n = p_{1}^{e_{1}} p_{2}^{e_{2}} \cdots p_{k}^{e_{k}}$, then
    \begin{equation*}
      \phi(n) = \left( p_{1}^{e_{1}} - p_{1}^{e_{1}-1} \right) \left( p_{2}^{e_{2}} - p_{2}^{e_{2}-1} \right) \cdots \left( p_{k}^{e_{k}} - p_{k}^{e_{k}-1} \right)
    \end{equation*}\label{prop:Euler_Phi_Function_Properties-Product_of_Primes}
  \end{propertylist}
\end{theorem}

\begin{example}[Exercise 1, Question 1.2a]{Euler Phi Function}
  Find the value of $\phi(36)$?
  \tcblower{}
  First, we note that 36 is not a \nameref{def:Prime} number, thus we need to find a set of primes that are equal to 36.
  The divisors of 36 are
  \begin{equation*}
    \lbrace \pm 1, \pm 2, \pm 3, \pm 4, \pm 9, \pm 12, \pm 18, \pm 36 \rbrace
  \end{equation*}
  And all possible prime numbers present as divisors of 36 are
  \begin{equation*}
    \lbrace 2, 3 \rbrace
  \end{equation*}

  So, there must be some combination of $2^{x}\cdot 3^{y}$ that yields 36.
  In fact, $2^{2} \cdot 3^{2} = 4 \cdot 9 = 36$.
  Since 36 can be broken up as a product of 2 \nameref{def:Prime} numbers raised to some power, we can use \Cref{prop:Euler_Phi_Function_Properties-Product_of_Primes} of the \nameref{def:Euler_Phi_Function} to simplify this.
  But first, we need to separate the two values from each other using \Cref{prop:Euler_Phi_Function_Properties-Split_Multiplication} of the \nameref{def:Euler_Phi_Function} to apply \Cref{prop:Euler_Phi_Function_Properties-Product_of_Primes}.

  We need to check $\gcd \left( 2^{2}, 3 ^{2} \right) = 1$.
  \begin{align*}
    \gcd \left( 2^{2}, 3^{2} \right) &= \gcd(4, 9) \\
    9 &= a4 + b \\
                                     &= 2 \cdot 4 + 1 \\
    4 &= a \cdot 1 + b \\
                                     &= 4 \cdot 1 + 0
  \end{align*}
  So, $\gcd \left( 2^{2}, 3^{2} \right) = 1$, so we can use \Cref{prop:Euler_Phi_Function_Properties-Split_Multiplication}.
  \begin{equation*}
    \phi \left( 2^{2} \cdot 3^{2} \right) = \phi \left( 2^{2} \right) \phi \left( 3^{2} \right)
  \end{equation*}
  And now we can apply \Cref{prop:Euler_Phi_Function_Properties-Product_of_Primes} to find our answer.

  \begin{align*}
    \phi \left( 2^{2} \right) \phi \left( 3^{2} \right) &= \left( 2^{2} - 2^{2-1} \right) \left( 3^{2} - 3^{2-1} \right) \\
                                                        &= (4-2)(9-3) \\
                                                        &= (2)(6) \\
                                                        &= 12
  \end{align*}
  Thus, $\phi(36) = 12$.
\end{example}

\begin{lemma}[Computing the \nameref{def:GCD}]\label{lemma:Compute_GCD}
  If $a$ and $b$ are positive integers where $a > b$, then
  \begin{equation}\label{eq:Compute_GCD}
    \gcd(a, b) = \gcd(b, a \bmod b)
  \end{equation}
  \begin{remark*}
    This can be repeated to efficiently calculate the $\gcd(a, b)$.
    This is called the \nameref{def:Euclidean_Algorithm}.
  \end{remark*}
\end{lemma}

\begin{definition}[Euclidean Algorithm]\label{def:Euclidean_Algorithm}
  The \emph{euclidean algorithm} is a way to efficiently calculate the $\gcd(a, b)$.
  
  \begin{algorithm}[H]
    \DontPrintSemicolon{}
    \SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}

    \Input{Two non-negative integers $a, b$ where $a \geq b$.}
    \Output{$\gcd(a, b)$.}
    \BlankLine{}
    Set $r_{0} \leftarrow a$, $r_{1} \leftarrow b$, $i \leftarrow 1$ \;
    \While{$r_{i} \neq 0$}{
      Set $r_{i+1} \leftarrow r_{i-1} \bmod r_{i}$ \;
      $i \leftarrow i+1$ \;
    }
    \Return{$r_{i}$}
    \caption{Euclidean Algorithm}
    \label{algo:Euclidean_Algorithm}
  \end{algorithm}
\end{definition}

\begin{example}[Exercise 1, Question 1.1a]{Euclidean Algorithm}
  Find the \nameref{def:GCD} of 222 and 1870?

  \tcblower{}

  \begin{align*}
    1870 &= a 222 + b \\
         &= 8 \cdot 222 + 94 \\
    222 &= a 94 + b \\
         &= 2 \cdot 94 + 34 \\
    94 &= a 34 + b \\
         &= 2 \cdot 34 + 26 \\
    34 &= a 26 + b \\
         &= 1 \cdot 26 + 8 \\
    26 &= a 8 + b \\
         &= 3 \cdot 8 + 2 \\
    8 &= a 2 + b \\
         &= 4 \cdot 2 + 0
  \end{align*}

  Thus, since $4 \cdot 2 = 8$, 2 is the \nameref{def:GCD} of 222 and 1870.
\end{example}

\begin{theorem}
  There exist integers $x, y$ such that $\gcd(a, b)$ can be written as
  \begin{equation}\label{eq:Extended_Euclidean_Algorithm_Basis}
    \gcd(a, b) = ax + by
  \end{equation}
\end{theorem}
\begin{proof}
  \begin{align*}
    \gcd(a, b) &= r_{i} \\
               &= r_{i-2} - q_{i-1}r_{i-1} \\
               &= r_{i-2} - q_{i-1}(r_{i-3} - q_{i-2}r_{i-2}) \\
               &\vdots \\
               &= r_{0}x + r_{1}y \\
               &= ax + by
  \end{align*}
  for some integers $x, y \in \AllIntegers$.
\end{proof}

This means that the \nameref{def:Euclidean_Algorithm} can be extended to return the values of $x$ and $y$ from \Cref{eq:Extended_Euclidean_Algorithm_Basis}.

\begin{definition}[Extended Euclidean Algorithm]\label{def:Extended_Euclidean_Algorithm}
  The \emph{extended euclidean algorithm} is a way to efficiently calculate the linear pair of integers ($x, y \in \AllIntegers$) that satisfy \Cref{eq:Extended_Euclidean_Algorithm_Basis}.
  \begin{equation*}
    \gcd(a, b) = ax + by
  \end{equation*}

  \begin{algorithm}[H]
    \DontPrintSemicolon{}
    \SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}

    \Input{Two non-negative integers $a, b$ where $a \geq b$.}
    \Output{$d = \gcd(a, b)$ and two integers $x, y$ such that $d = ax + by$.}
    \BlankLine{}

    \If{$b=0$}{
      \Return{$a$, $x \leftarrow 1$, $y \leftarrow 0$}
    }
    Set $x_{2} \leftarrow 1$, $x_{1} \leftarrow 0$, $y_{2} \leftarrow 0$, and $y_{1} \leftarrow 1$. \;
    \While{$b > 0$}{
      $q \leftarrow a \div b$. \;
      $r \leftarrow a-qb$, $x \leftarrow x_{2} - qx_{1}$, $y \leftarrow y_{2} - qy_{1}$. \;
      $a \leftarrow b$
      $b \leftarrow r$
      $x_{2} \leftarrow x_{1}$, $x_{1} \leftarrow x$, $y_{2} \leftarrow y_{1}$, and $y_{1} \leftarrow y$. \;
    }
    Set $d \leftarrow a$, $x \leftarrow x_{2}$, $y \leftarrow y_{2}$. \;
    \Return{$d, x, y$}
    \caption{Extended Euclidean Algorithm (Bezout's Theorem)}
    \label{algo:Extended_Euclidean_Algorithm}
  \end{algorithm}
\end{definition}

\begin{example}[Exercise 1, Question 1.1b]{Extended Euclidean Algorithm}
  Find the integers $x$ and $y$ such that $\gcd(222, 1870) = 222x + 1870y$?
  \tcblower{}
  From \Cref{ex:Euclidean Algorithm}, we know $\gcd(222, 1870) = 2$, so we can plug that in.
  We now know that
  \begin{equation*}
    2 = 222x + 1870y
  \end{equation*}

  Now, we essentially run the \nameref{def:Euclidean_Algorithm} backwards.
  \begin{align*}
    2 &= 26 - 3 \cdot 8 \\
      &= 26 - 3(34 - 1 \cdot 26) = 26 - 3 \cdot 34 + 3 \cdot 26 \\
      &= 4 \cdot 26 - 3 \cdot 34 \\
      &= 4(94 - 2 \cdot 34) - 3 \cdot 34 = 4 \cdot 94 - 8 \cdot 34 - 3 \cdot 34\\
      &= 4 \cdot 94 - 11 \cdot 34 \\
      &= 4 \cdot 94 - 11(222 - 2 \cdot 94) = 4 \cdot 94 - 11 \cdot 222 + 22 \cdot 94 \\
      &= 26 \cdot 94 - 22 \cdot 222 \\
      &= 26(1870 - 8 \cdot 222) - 22 \cdot 222 = 26 \cdot 1870 - 208 \cdot 222 - 11 \cdot 222 \\
      &= -219 \cdot 222 + 26 \cdot 1870
  \end{align*}
  Now we need to check the solution we might have found
  \begin{align*}
    -219 \cdot 222 + 26 \cdot 1870 &= 2 \\
    -48618 + 48620 &= 2 \\
    2 &= 2
  \end{align*}

  Thus,
  \begin{align*}
    x &= -219 \\
    y &= 26
  \end{align*}
\end{example}

\subsection{\texorpdfstring{The Integers modulo $n$}{The Integers modulo n}}\label{subsec:Integer_Modulo_n}
Let $n$ be a positive integer.
\begin{definition}[Congruence]\label{def:Congruence}
  If $a$ and $b$ are integers, then \emph{$a$ is said to be congruent to $b$ modulo $n$}, which is written as
  \begin{equation}\label{eq:A_Congruent_B}
    a \equiv b \pmod{n}
  \end{equation}

  If $n$ divides $(a-b)$, i.e. $n \Divides (a-b)$, then we call $n$ the \emph{modulus} of the congruence.

\end{definition}

\begin{theorem}
  For $a, a_{1}, b, b_{1}, c\in \AllIntegers$, we have
  \begin{propertylist}
  \item $a \equiv b \pmod{n}$ \emph{if and only if} $a$ and $b$ leave the same \nameref{def:Integer_Remainder} when divided by $n$.
  \item $a \equiv a \pmod{n}$ \label{prop:A_Congruent_B_Reflexivity}
  \item If $a \equiv b \pmod{n}$, then $b \equiv a \pmod{n}$ \label{prop:A_Congruent_B_Symmetry}
  \item If $a \equiv b \pmod{n}$ adn $b \equiv c \pmod{n}$, then $a \equiv c \pmod{n}$ \label{prop:A_Congruent_B_Transitivity}
  \item If $a \equiv a_{1} \pmod{n}$ and $b \equiv b_{1} \pmod{n}$, then $a+b = a_{1} + b_{1} \pmod{n}$ and $ab = a_{1}b_{1} \pmod{n}$.
  \end{propertylist}

  \Crefrange{prop:A_Congruent_B_Reflexivity}{prop:A_Congruent_B_Transitivity} are called \emph{reflexivity}, \emph{symmetry}, and \emph{transitivity}, respectively.
\end{theorem}

\begin{example}[Exercise 1, Question 1.2b]{Integers modulo n}
  Write all the units (\nameref{def:Invertible_Element}) in \TextIntsMod{36}?
  \tcblower{}
  First, we start by constructing our set of integers modulo $n$.
  \begin{equation*}
    \IntsMod{36} = \bigl\lbrace [0], [1], [2], [3], [4], \ldots, [35] \bigr\rbrace
  \end{equation*}

  Since we are only worried about the units of \TextIntsMod{36}, we need to find the integers that satisfy \Cref{eq:Invertible_Element}.
  This is done by finding an $a$ value that has a \nameref{def:Multiplicative_Inverse}, which requires that \Cref{eq:Invertible} be true, namely
  \begin{equation*}
    \gcd(a, n) = 1
  \end{equation*}
  This leaves us with
  \begin{equation*}
    \IntsMod{36} = \bigl\lbrace [1], [5], [7], [11], [13], [17], [19], [23], [25], [29], [31], [35] \bigr\rbrace
  \end{equation*}
  which is the solution.
\end{example}

\subsection{Equivalence Classes}\label{subsec:Equivalence_Classes}
\begin{definition}[Equivalence Class]\label{def:Equivalence_Class}
  \nameref{def:Congruence} modulo $n$ partitions $\AllIntegers$ into $n$ sets, called \emph{equivalence class}es, where each integer belongs to exactly one equivalence class.

  For example, these are all congruent to each other modulo $n$:
  \begin{subequations}\label{eq:Equivalence_Class}
    \begin{equation}\label{subeq:Equivalence_Class_Remainder_0}
      [0] = \lbrace \ldots, -2n, -n,\, 0, n, 2n, \ldots \rbrace
    \end{equation}
    \begin{equation}\label{subeq:Equivalence_Class_Remainder_1}
      [1] = \lbrace \ldots -2n + 1, -n+1,\, 1, n+1, 2n+1 \ldots \rbrace
    \end{equation}
    \begin{equation}\label{eq:General_Equivalent_Class_Remainder}
      [r] = \IntsMod{r} = (x \bmod r) + n\AllIntegers
    \end{equation}
  \end{subequations}

  Since all elements in an equivalent class have the same \nameref{def:Integer_Remainder}, $r$, we use $r$ as a \emph{represenatative} for the equivalence class.
  \begin{remark}
    In this case, the representatives of the equivalence classes shown in \Crefrange{subeq:Equivalence_Class_Remainder_0}{subeq:Equivalence_Class_Remainder_1} are 0 and 1, respectively, and consist of all integers that are mod 0 or mod 1, respectively.
  \end{remark}
\end{definition}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../EDIN01-Cryptography-Reference_Sheet"
%%% End:
