\subsection{Flow Control}\label{subsec:Flow_Control}
\defFlowControl{}
\defSlidingWindow{}

\begin{definition}[Credit-Based Scheme]\label{def:Credit_Based_Scheme}
  In a \emph{credit-based scheme}, the receiver gives the sender ``credit'' that is used when the sender transmits information.
  Unlike the \nameref{def:Token_Bucket_Scheme}, the sender does not ``get credit'' while it is sending information.
  Instead, the sender gets its credit all at once, after sending all it can/wants.
  The rate at which this credit is used is different depending on what is sending, the shape of the network traffic, and other factors.
\end{definition}

\subsubsection{TCP Flow Control}\label{subsubsec:TCP_Flow_Control}
\nameref{def:Transmission_Control_Protocol} uses a form of \nameref{def:Sliding_Window} that differes from windows used in other protocols.
Namely, the \textbf{acknowledgement of received data} and the \textbf{granting of permission} to send more is \textbf{decoupled}.

TCP's flow control is known as a Credit Allocation Scheme, or a \nameref{def:Credit_Based_Scheme}.

\paragraph{TCP Header Fields for Flow Control}\label{par:TCP_Header_Fields_Flow_Control}
For TCP to perform its \nameref{def:Flow_Control}, it must have a way to track which packets have been received.
This way, if any are lost, they can be retransmitted.

\begin{itemize}[noitemsep]
\item This is done with the \emph{Sequence Number} of the packet.
  \begin{itemize}[noitemsep]
  \item Throughout this portion of the document, the sequence number will be represented by $SN$ in mathematical calculations.
  \end{itemize}
\item When the recipient receives the information successfully, it sends an \emph{Acknowledgement (\texttt{ACK}) Number}.
  \begin{itemize}[noitemsep]
  \item Throughout this portion of the document, the acknowledgement number will be represented by $AN$ in mathematical calculations.
  \end{itemize}
\item The control of which $SN$ to send after recieving the $AN$ is determined by the \emph{Window} ($W$).
\end{itemize}

If an \texttt{ACK} contains
\begin{align*}
  AN &= i \\
  W &= j
\end{align*}
then,
\begin{itemize}[noitemsep]
\item $SN$s from $SN = i - 1$ are acknowledged.
\item Permission is granted to send $W = j$ \textbf{more} packets.
  This means packets $i$ to $i + j - 1$ can be sent.
\end{itemize}

\paragraph{Flexible Credit Allocation}\label{par:TCP_Flexible_Credit_Allocation}
The benefit of using this window method in TCP is that the process of allocating credit is flexible, meaning from one round of transmission to the next, different amounts may be sent.

Suppose the last message $B$ sent had
\begin{align*}
  AN &= i \\
  W &= j
\end{align*}

If we want to increase the credit to $k$, i.e.\ $k > j$ when there is no new data, $B$ can issue
\begin{align*}
  AN &= i \\
  W &= k
\end{align*}

\paragraph{Credit Allocation Policy}\label{par:TCP_Credit_Allocation_Policy}
\paragraph{Effect of Window Size}\label{par:TCP_Window_Size_Effect}
\paragraph{Complicating Factors}\label{par:TCP_Complicating_Factors}
\subsubsection{Retransmission Policies}\label{subsubsec:Retransmission_Policies}
\subsubsection{Timers}\label{subsubsec:Packet_Timers}
\paragraph{Fixed Timers}\label{par:Fixed_Packet_Timers}
\paragraph{Adaptive Timers}\label{par:Adaptive_Packet_Timers}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../ETSN10-Network_Architecture_Performance-Reference_Sheet"
%%% End:
