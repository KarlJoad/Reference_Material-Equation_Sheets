\subsection{Allocating Kernel Memory}\label{subsec:Allocating_Kernel_Memory}
When a \nameref{def:Process} running in \nameref{def:User} mode requests additional memory, pages are allocated from the list of free page frames maintained by the \nameref{def:Kernel}.
This list is typically populated using a \nameref{def:Page_Replacement} algorithm and most likely contains free pages scattered throughout physical memory.
Additionally, \nameref{def:Internal_Fragmentation} may result, as the process will be granted an entire page frame, even if it doesn't need all of it..

\nameref{def:Kernel} memory is often allocated from a free-memory pool \textbf{different} from the list used to satisfy ordinary user-mode processes.
There are two primary reasons for this:
\begin{enumerate}[noitemsep]
\item The \nameref{def:Kernel} requests memory for data structures of varying sizes, some of which are less than a page in size.
  As a result, the kernel must use memory conservatively and attempt to minimize waste due to \nameref{def:Fragmentation}.
  Many \nameref{def:Operating_System}s do not subject kernel code or data to the paging system.
\item Pages allocated to \nameref{def:User}-mode processes do not necessarily have to be in contiguous physical memory.
  However, certain hardware devices interact directly with physical memory, not the \nameref{def:Virtual_Memory} interface.
  Consequently, the devices may require memory residing in \textbf{physically} contiguous pages.
\end{enumerate}

We discuss 2 systems for allocating memory to \nameref{def:Kernel} \nameref{def:Process}es.
\begin{enumerate}[noitemsep]
\item \nameref{subsubsec:Buddy_System}
\item \nameref{subsubsec:Slab_Allocation}
\end{enumerate}

\subsubsection{Buddy System}\label{subsubsec:Buddy_System}
The buddy system allocates memory from a fixed-size segment consisting of \textbf{physically contiguous pages}.
Memory is allocated from this segment using a \emph{power-of-2 allocator}, which satisfies requests in units sized as a power of 2 (\SIlist{4;8;16}{\kibi{} \byte{}}, and so forth).
All requests are rounded up to the next appropriate highest power of 2.
For example, a request for \SI{11}{\kibi{} \byte{}} is satisfied with a \SI{16}{\kibi{} \byte{}} segment.

\paragraph{Benefits of the Buddy System}\label{par:Buddy_System_Benefits}
An advantage of the buddy system is how quickly adjacent buddies can be combined to form larger segments using a technique known as \emph{coalescing}.

\paragraph{Drawbacks of the Buddy System}\label{par:Buddy_System_Drawbacks}
The drawback to the buddy system is that rounding up to the next highest power of 2 will likely cause \nameref{def:Fragmentation} within allocated segments.

\subsubsection{Slab Allocation}\label{subsubsec:Slab_Allocation}
There are several components that make up the slab allocation scheme:
\begin{itemize}[noitemsep]
\item \nameref{def:Slab}
\item \nameref{def:Slab_Cache}
\item \nameref{def:Slab_Object}
\end{itemize}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../EDAF35-Operating_Systems-Reference_Sheet"
%%% End:
